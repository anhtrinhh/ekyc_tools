var __EkycToolsLibrary__;(()=>{"use strict";var e={d:(t,r)=>{for(var n in r)e.o(r,n)&&!e.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:r[n]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},t={};e.r(t),e.d(t,{EkycTools:()=>H});var r,n='<svg viewBox="0 0 24 24"><path d="M7 2v11h3v9l7-12h-4l4-8z"></path></svg>',i=function(e,t,r,n){return new(r||(r=Promise))((function(i,o){function a(e){try{c(n.next(e))}catch(e){o(e)}}function s(e){try{c(n.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}c((n=n.apply(e,t||[])).next())}))},o=function(e,t){var r,n,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(s){return function(c){return function(s){if(r)throw new TypeError("Generator is already executing.");for(;o&&(o=0,s[0]&&(a=0)),a;)try{if(r=1,n&&(i=2&s[0]?n.return:s[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,s[1])).done)return i;switch(n=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,n=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!((i=(i=a.trys).length>0&&i[i.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){a.label=s[1];break}if(6===s[0]&&a.label<i[1]){a.label=i[1],i=s;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(s);break}i[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],n=0}finally{r=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},a=function(e,t,r){if(r||2===arguments.length)for(var n,i=0,o=t.length;i<o;i++)!n&&i in t||(n||(n=Array.prototype.slice.call(t,0,i)),n[i]=t[i]);return e.concat(n||Array.prototype.slice.call(t))},s=function(){function e(){}return e.handleScreen=function(e){var t=this,r=e.closest(".ekyct-body");r&&(r.style.height="100%"),setTimeout((function(){var r=e.closest(".ekyct-container--inner");if(r.clientWidth>=r.clientHeight?r.classList.add("ekyct-container--rotate"):r.classList.remove("ekyct-container--rotate"),e){var n=parseFloat(e.dataset.shadingRatio||"0"),i=t.insertShadingElement(e,n);if(t.insertCanvasElement(e),i){var o=r.querySelector(".ekyct-header"),a=parseFloat(i.style.height.slice(0,-2));o&&r.classList.contains("ekyct-container--rotate")?o.style.height="".concat(a,"px"):o.style.height="unset"}}}),100)},e.insertCanvasElement=function(e){var t,r=e.querySelector(".ekyct-shading");if(e.querySelector(".ekyct-video")){var n=0,i=0,o=e.clientWidth,a=this.getCaptureRegionHeight(e);r&&(n=2*parseFloat(r.style.borderLeftWidth.slice(0,-2)),i=2*parseFloat(r.style.borderTopWidth.slice(0,-2)),o=parseFloat(r.style.width.slice(0,-2)),a=parseFloat(r.style.height.slice(0,-2))),null===(t=e.querySelector(".ekyct-canvas"))||void 0===t||t.remove();var s=o-n,c=a-i,l=document.createElement("canvas");return l.className="ekyct-canvas",l.style.width="".concat(s,"px"),l.style.height="".concat(c,"px"),l.style.display="none",e.appendChild(l),l}return null},e.insertShadingElement=function(e,t){var r,n=e.querySelector(".ekyct-video");if(n&&t>0){null===(r=e.querySelector(".ekyct-shading"))||void 0===r||r.remove();var i=n.clientWidth,o=this.getCaptureRegionHeight(e),a=document.createElement("div");a.className="ekyct-shading",a.style.width="".concat(i,"px"),a.style.height="".concat(o,"px");var s=this.getShadingBorderSize(i,o,t);return a.style.borderLeftWidth="".concat(s.borderX,"px"),a.style.borderRightWidth="".concat(s.borderX,"px"),a.style.borderTopWidth="".concat(s.borderY,"px"),a.style.borderBottomWidth="".concat(s.borderY,"px"),this.insertShaderBorders(a,this.shardBorderLargeSize,this.shardBorderSmallSize,-this.shardBorderSmallSize,null,0,!0),this.insertShaderBorders(a,this.shardBorderLargeSize,this.shardBorderSmallSize,-this.shardBorderSmallSize,null,0,!1),this.insertShaderBorders(a,this.shardBorderLargeSize,this.shardBorderSmallSize,null,-this.shardBorderSmallSize,0,!0),this.insertShaderBorders(a,this.shardBorderLargeSize,this.shardBorderSmallSize,null,-this.shardBorderSmallSize,0,!1),this.insertShaderBorders(a,this.shardBorderSmallSize,this.shardBorderLargeSize+this.shardBorderSmallSize,-this.shardBorderSmallSize,null,-this.shardBorderSmallSize,!0),this.insertShaderBorders(a,this.shardBorderSmallSize,this.shardBorderLargeSize+this.shardBorderSmallSize,null,-this.shardBorderSmallSize,-this.shardBorderSmallSize,!0),this.insertShaderBorders(a,this.shardBorderSmallSize,this.shardBorderLargeSize+this.shardBorderSmallSize,-this.shardBorderSmallSize,null,-this.shardBorderSmallSize,!1),this.insertShaderBorders(a,this.shardBorderSmallSize,this.shardBorderLargeSize+this.shardBorderSmallSize,null,-this.shardBorderSmallSize,-this.shardBorderSmallSize,!1),this.insertCircleRegion(a),e.appendChild(a),a}return null},e.insertShaderBorders=function(e,t,r,n,i,o,a){var s=document.createElement("div");s.className="ekyct-shader-border",s.style.width="".concat(t,"px"),s.style.height="".concat(r,"px"),null!==n&&(s.style.top="".concat(n,"px")),null!==i&&(s.style.bottom="".concat(i,"px")),a?s.style.left="".concat(o,"px"):s.style.right="".concat(o,"px"),e.appendChild(s)},e.getShadingBorderSize=function(t,r,n){var i=e.adjustExactRatio([t,r,n]),o=(t-i[0])/2,a=(r-i[1])/2;return a<3*this.shardBorderSmallSize&&(o+=3*this.shardBorderSmallSize-a,a=3*this.shardBorderSmallSize),o<3*this.shardBorderSmallSize&&(a+=3*this.shardBorderSmallSize-o,o=3*this.shardBorderSmallSize),{borderX:o,borderY:a}},e.cleanAlert=function(t){var r=t.querySelector(".ekyct-alert");r&&r.classList.contains("active")&&(e.insertAlertTimeout?setTimeout((function(){r.classList.remove("active"),setTimeout((function(){r.remove()}),200)}),400):(r.classList.remove("active"),setTimeout((function(){r.remove()}),200)))},e.insertAlert=function(t,r,n,i,o,a){if(void 0===a&&(a=2e3),t){var s=t.querySelector(".ekyct-alert");s?this.getAlertContent(s)!==r&&(s.classList.contains("active")&&!e.insertAlertTimeout&&s.classList.remove("active"),e.insertAlertTimeout||(this.setAlertContent(s,r),"number"==typeof a&&a>=1e3?e.setInsertAlertTimeout(s,a+200,200):s.classList.add("active"))):(s=this.createAlertElement(r,i,n,o),t.appendChild(s),s.classList.contains("active")||e.insertAlertTimeout||(this.setAlertContent(s,r),"number"==typeof a&&a>=1e3?e.setInsertAlertTimeout(s,a+20,20):s.classList.add("active")))}},e.createAlertElement=function(e,t,r,n){var i,o=document.createElement("div"),s=["ekyct-alert"];if("string"==typeof t&&t.trim().length>0||"boolean"==typeof n&&n){var c=document.createElement("div");if(c.className="ekyct-alert-header","string"==typeof t){t=t.trim();var l=document.createElement("div");l.className="ekyct-alert-title",c.appendChild(l),l.innerHTML=t,s.push("ekyct-alert-column")}if("boolean"==typeof n&&n){var u=document.createElement("button");u.className="ekyct-btn ekyct-alert-close-btn",u.innerHTML='<svg viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"></path></svg>',u.addEventListener("click",(function(e){e.preventDefault(),o.classList.remove("active")}),{once:!0}),c.appendChild(u)}o.appendChild(c)}var d=document.createElement("div");return d.className="ekyct-alert-body",o.appendChild(d),Array.isArray(r)&&r.length>0&&(s=a(a([],s,!0),r,!0)),"string"==typeof e&&e.trim().length>0&&(e=e.trim(),d.innerHTML=e),(i=o.classList).add.apply(i,s),o},e.setAlertContent=function(e,t){if("string"==typeof t&&t.trim().length>0){var r=e.querySelector(".ekyct-alert-body");r&&(r.innerHTML=t)}},e.getAlertContent=function(e){var t=e.querySelector(".ekyct-alert-body");return t?t.innerHTML:""},e.setInsertAlertTimeout=function(t,r,n){e.insertAlertTimeout=setTimeout((function(){t.classList.add("active"),setTimeout((function(){e.clearInsertAlertTimeout()}),r)}),n)},e.clearInsertAlertTimeout=function(){e.insertAlertTimeout&&(clearTimeout(e.insertAlertTimeout),e.insertAlertTimeout=null)},e.delay=function(e){return new Promise((function(t){setTimeout(t,e)}))},e.toggleLoader=function(t,r){if(void 0===t&&(t=!0),void 0===r&&(r=document.body),r){var n=r.querySelector(".ekyct-loader");if(n&&n.remove(),t){var i=e.createLoaderElement();r.appendChild(i)}}},e.toggleLoaderOnCaptureRegion=function(e,t){void 0===e&&(e=!0),t&&(e?t.classList.add("ekyct-hide-shading"):t.classList.remove("ekyct-hide-shading"),this.toggleLoader(e,t))},e.insertCircleRegion=function(e){var t=document.createElement("div"),r=parseFloat(e.style.width.slice(0,-2))-2*parseFloat(e.style.borderLeftWidth.slice(0,-2));t.className="ekyct-circle-region";for(var n=0;n<100;n++){var i=document.createElement("div");i.className="ekyct-circle-region-point",t.appendChild(i),i.style.transform="rotate(".concat(3.6*n,"deg) translateY(").concat(r/2-10,"px)")}e.appendChild(t)},e.createLoaderElement=function(){var e=document.createElement("div");e.className="ekyct-loader";var t=document.createElement("div");t.className="ekyct-loader-content";for(var r=1;r<=10;r++){var n=document.createElement("span");n.setAttribute("style","--i:"+r),t.appendChild(n)}return e.appendChild(t),e},e.newGuid=function(){var e="xxxxxxxx-xxxx-4xxx-yxxx-".replace(/[xy]/g,(function(e){var t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)})),t=new Date;return e+="".concat(t.getUTCFullYear()),t.getUTCMonth()<9?e+="0".concat(t.getUTCMonth()+1):e+=t.getUTCMonth()+1,t.getUTCDate()<10?e+="0".concat(t.getUTCDate()):e+="".concat(t.getUTCDate()),t.getUTCHours()<10?e+="0".concat(t.getUTCHours()):e+=t.getUTCHours(),t.getUTCMinutes()<10?e+="0".concat(t.getUTCMinutes()):e+=t.getUTCMinutes(),t.getUTCSeconds()<10?e+="0".concat(t.getUTCSeconds()):e+=t.getUTCSeconds(),e},e.getCapabilitiesOfFacingMode=function(t){return i(this,void 0,void 0,(function(){var r,n,i;return o(this,(function(o){switch(o.label){case 0:if("environment"!==t&&"user"!==t)return[2,void 0];o.label=1;case 1:return o.trys.push([1,3,,4]),[4,navigator.mediaDevices.getUserMedia({audio:!1,video:{facingMode:{exact:t}}})];case 2:return r=o.sent(),n=r.getVideoTracks()[0],i=n.getCapabilities(),e.clearMediaStream(r),[2,i];case 3:return o.sent(),[2,void 0];case 4:return[2]}}))}))},e.getCapabilitiesBothCam=function(){return i(this,void 0,void 0,(function(){var t,r,n,i,a;return o(this,(function(o){switch(o.label){case 0:return[4,e.getCapabilitiesOfFacingMode("user")];case 1:return t=o.sent(),[4,e.getCapabilitiesOfFacingMode("environment")];case 2:return r=o.sent(),i=null,(n=void 0!==t||void 0!==r)?t?[3,4]:[4,navigator.mediaDevices.getUserMedia({audio:!1,video:{facingMode:"user"}})]:[3,7];case 3:return i=o.sent(),a=i.getVideoTracks()[0],t=a.getCapabilities(),[3,6];case 4:return r?[3,6]:[4,navigator.mediaDevices.getUserMedia({audio:!1,video:{facingMode:"environment"}})];case 5:i=o.sent(),a=i.getVideoTracks()[0],r=a.getCapabilities(),o.label=6;case 6:return[3,9];case 7:return[4,navigator.mediaDevices.getUserMedia({audio:!1,video:!0})];case 8:i=o.sent(),a=i.getVideoTracks()[0],t=a.getCapabilities(),o.label=9;case 9:return e.clearMediaStream(i),[2,{hasBoth:n,frontCamCapabilities:t,rearCamCapabilities:r}]}}))}))},e.clearMediaStream=function(e){e&&e.getTracks().forEach((function(t){null==e||e.removeTrack(t),t.stop()}))},e.adjustRatio=function(e){var t=e[0],r=e[1],n=e[2];if(t/r===n)return[t,r];var i=Math.min(t,Math.floor(r*n));return[i,Math.round(i/n)]},e.adjustExactRatio=function(e){var t=e[0],r=e[1],n=e[2];if(t/r===n)return[t,r];var i=Math.min(t,r*n);return[i,i/n]},e.requestFullscreen=function(){return i(this,void 0,void 0,(function(){var e;return o(this,(function(t){switch(t.label){case 0:return t.trys.push([0,3,,4]),document.fullscreenEnabled?[4,document.documentElement.requestFullscreen()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[3,4];case 3:return e=t.sent(),console.warn(e),[3,4];case 4:return[2]}}))}))},e.exitFullscreen=function(){return i(this,void 0,void 0,(function(){var e;return o(this,(function(t){switch(t.label){case 0:return t.trys.push([0,3,,4]),null==document.fullscreenElement?[3,2]:[4,document.exitFullscreen()];case 1:t.sent(),t.label=2;case 2:return[3,4];case 3:return e=t.sent(),console.warn(e),[3,4];case 4:return[2]}}))}))},e.getVideoRatios=function(e,t){var r=e.videoWidth/e.clientWidth,n=e.videoHeight/e.clientHeight,i=r,o=n;return"number"==typeof t&&t>0&&(r>=n?r>t&&(i=t,o=t/(r/n)):n>t&&(o=t,i=t/(n/r))),{originWidthRatio:r,originHeightRatio:n,newWidthRatio:i,newHeightRatio:o}},e.getCaptureRegionHeight=function(e){var t=e.closest(".ekyct-container--inner"),r=e.querySelector(".ekyct-video"),n=t.querySelector(".ekyct-header"),i=t.querySelector(".ekyct-footer"),o=t.querySelector(".ekyct-body"),a=180;n&&i&&(a=n.clientHeight+i.clientHeight),t.classList.contains("ekyct-container--rotate")&&(a=0);var s=window.innerHeight-a;return r&&s>r.clientHeight&&(s=r.clientHeight),o&&(o.style.height=a>0?"".concat(s,"px"):"100%"),s},e.getCanvasContextWidth=function(t,r,n,i){var o=0,a=n;r&&(o=parseFloat(r.style.borderLeftWidth.slice(0,-2)),a=parseFloat(r.style.width.slice(0,-2)));var s=e.getVideoRatios(t,i).newWidthRatio,c=a-2*o,l=Math.round(c*s);return l%2!=0&&(l-=1),l},e.getInnerElementsInCaptureDiv=function(e){return{canvasEl:e.querySelector(".ekyct-canvas"),videoEl:e.querySelector(".ekyct-video"),shadingEl:e.querySelector(".ekyct-shading")}},e.isNullOrUndefined=function(e){return null==e},e.clip=function(e,t,r){return e>r?r:e<t?t:e},e.instanceOfGetVideoConfig=function(e){return"recordMs"in e},e.queryByClassName=function(e,t){return void 0===t&&(t=document.body),t.querySelector(".".concat(e))},e.closestByClassName=function(e,t){return t.closest(".".concat(e))},e.isMediaStreamConstraintsValid=function(e,t){if(!e)return t.logError("Empty videoConstraints",!0),!1;if("object"!=typeof e){var r=typeof e;return t.logError("videoConstraints should be of type object, the "+"object passed is of type ".concat(r,"."),!0),!1}for(var n=new Set(["autoGainControl","channelCount","echoCancellation","latency","noiseSuppression","sampleRate","sampleSize","volume"]),i=0,o=Object.keys(e);i<o.length;i++){var a=o[i];if(n.has(a))return t.logError("".concat(a," is not supported videoConstaints."),!0),!1}return!0},e.createVideoConstraints=function(e){if("string"==typeof e)return{deviceId:{exact:e}};if("object"==typeof e){var t="facingMode",r="deviceId",n={user:!0,environment:!0},i="exact",o=function(e){if(e in n)return!0;throw"config has invalid 'facingMode' value = "+"'".concat(e,"'")},a=Object.keys(e);if(1!==a.length)throw"'cameraIdOrConfig' object should have exactly 1 key,"+" if passed as an object, found ".concat(a.length," keys");var s=Object.keys(e)[0];if(s!==t&&s!==r)throw"Only '".concat(t,"' and '").concat(r,"' ")+" are supported for 'cameraIdOrConfig'";if(s!==t){var c=e.deviceId;if("string"==typeof c)return{deviceId:c};if("object"==typeof c){if(i in c)return{deviceId:{exact:c["".concat(i)]}};throw"'deviceId' should be string or object with"+" ".concat(i," as key.")}throw"Invalid type of 'deviceId' = ".concat(typeof c)}var l=e.facingMode;if("string"==typeof l){if(o(l))return{facingMode:l}}else{if("object"!=typeof l)throw"Invalid type of 'facingMode' = ".concat(typeof l);if(!(i in l))throw"'facingMode' should be string or object with"+" ".concat(i," as key.");if(o(l["".concat(i)]))return{facingMode:{exact:l["".concat(i)]}}}}throw"Invalid type of 'cameraIdOrConfig' = ".concat(typeof e)},e.insertAlertTimeout=null,e.shardBorderLargeSize=40,e.shardBorderSmallSize=5,e}(),c=function(){function e(){}return e.CONTAINER_DIV="ekyct-container",e.CONTAINER_INNER_DIV="ekyct-container--inner",e.HEADER_DIV="ekyct-header",e.HEADER_INNER_DIV="ekyct-header--inner",e.BODY_DIV="ekyct-body",e.FOOTER_DIV="ekyct-footer",e.FOOTER_INNER_DIV="ekyct-footer--inner",e.CONTAINER_INNER_ROTATE_DIV="ekyct-container--rotate",e.CAPTURE_REGION_DIV="ekyct-capture-region",e.FILE_PICKER_BTN="ekyct-filepicker-btn",e.CAPTURE_BTN="ekyct-capture-btn",e.RECORD_BTN="ekyct-record-btn",e.FLASH_BTN="ekyct-flash-btn",e.CLOSE_BTN="ekyct-close-btn",e.SWITCH_CAMERA_BTN="ekyct-switchcam-btn",e.VIDEO="ekyct-video",e.SHADING_DIV="ekyct-shading",e.CANVAS="ekyct-canvas",e.LOADER_DIV="ekyct-loader",e.ZOOM_CONTAINER_DIV="ekyct-zoom-container",e.LOADER_CONTENT_DIV="ekyct-loader-content",e.CIRCULAR_PROGRESS="ekyct-circular-progress",e.DNONE="ekyct-dnone",e}(),l=function(){function e(){}return e.UI_LOADING="loading",e.UI_LOADED="loaded",e.SWITCH_CAMERA="switchCamera",e}(),u=(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},r(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),d=function(e,t,r,n){return new(r||(r=Promise))((function(i,o){function a(e){try{c(n.next(e))}catch(e){o(e)}}function s(e){try{c(n.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}c((n=n.apply(e,t||[])).next())}))},h=function(e,t){var r,n,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(s){return function(c){return function(s){if(r)throw new TypeError("Generator is already executing.");for(;o&&(o=0,s[0]&&(a=0)),a;)try{if(r=1,n&&(i=2&s[0]?n.return:s[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,s[1])).done)return i;switch(n=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,n=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!((i=(i=a.trys).length>0&&i[i.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){a.label=s[1];break}if(6===s[0]&&a.label<i[1]){a.label=i[1],i=s;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(s);break}i[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],n=0}finally{r=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},p=function(){function e(e,t){this.name=e,this.track=t}return e.prototype.isSupported=function(){return!!this.track.getCapabilities&&this.name in this.track.getCapabilities()},e.prototype.apply=function(e){var t={};t[this.name]=e;var r={advanced:[t]};return this.track.applyConstraints(r)},e.prototype.value=function(){var e=this.track.getSettings();return this.name in e?e[this.name]:null},e}(),f=function(e){function t(t){return e.call(this,"zoom",t)||this}return u(t,e),t}(function(e){function t(t,r){return e.call(this,t,r)||this}return u(t,e),t.prototype.min=function(){return this.getCapabilities().min},t.prototype.max=function(){return this.getCapabilities().max},t.prototype.step=function(){return this.getCapabilities().step},t.prototype.apply=function(e){var t={};t[this.name]=e;var r={advanced:[t]};return this.track.applyConstraints(r)},t.prototype.getCapabilities=function(){this.failIfNotSupported();var e=this.track.getCapabilities()[this.name];return{min:e.min,max:e.max,step:e.step}},t.prototype.failIfNotSupported=function(){if(!this.isSupported())throw new Error("".concat(this.name," capability not supported"))},t}(p)),m=function(e){function t(t){return e.call(this,"torch",t)||this}return u(t,e),t}(p),y=function(){function e(e){this.track=e}return e.prototype.zoomFeature=function(){return new f(this.track)},e.prototype.flashFeature=function(){return new m(this.track)},e}(),v=function(){function e(e,t,r){this.isClosed=!1,this.parentElement=e,this.mediaStream=t,this.callbacks=r,this.surface=this.createVideoElement(),e.append(this.surface)}return e.prototype.createVideoElement=function(){var e=document.createElement("video");return e.className=c.VIDEO,e.muted=!0,e.setAttribute("muted","true"),e.playsInline=!0,e},e.prototype.setupSurface=function(){var e=this;this.surface.onabort=function(){throw"RenderedCameraImpl video surface onabort() called"},this.surface.onerror=function(){throw"RenderedCameraImpl video surface onerror() called"};var t=function(){var r=e.surface.clientWidth,n=e.surface.clientHeight;e.callbacks.onRenderSurfaceReady(r,n),e.surface.removeEventListener("playing",t)};this.surface.addEventListener("playing",t),this.surface.srcObject=this.mediaStream,this.surface.play()},e.create=function(t,r,n){return d(this,void 0,void 0,(function(){var i;return h(this,(function(o){return(i=new e(t,r,n)).setupSurface(),[2,i]}))}))},e.prototype.failIfClosed=function(){if(this.isClosed)throw"The RenderedCamera has already been closed."},e.prototype.getFirstTrackOrFail=function(){if(this.failIfClosed(),0===this.mediaStream.getVideoTracks().length)throw"No video tracks found";return this.mediaStream.getVideoTracks()[0]},e.prototype.pause=function(){this.failIfClosed(),this.surface.pause()},e.prototype.resume=function(e){this.failIfClosed();var t=this,r=function(){setTimeout(e,200),t.surface.removeEventListener("playing",r)};this.surface.addEventListener("playing",r),this.surface.play()},e.prototype.isPaused=function(){return this.failIfClosed(),this.surface.paused},e.prototype.getStream=function(){return this.mediaStream},e.prototype.getSurface=function(){return this.failIfClosed(),this.surface},e.prototype.getRunningTrackCapabilities=function(){return this.getFirstTrackOrFail().getCapabilities()},e.prototype.getRunningTrackSettings=function(){return this.getFirstTrackOrFail().getSettings()},e.prototype.applyVideoConstraints=function(e){return d(this,void 0,void 0,(function(){return h(this,(function(t){if("aspectRatio"in e)throw"Changing 'aspectRatio' in run-time is not yet supported.";return[2,this.getFirstTrackOrFail().applyConstraints(e)]}))}))},e.prototype.close=function(){if(this.isClosed)return Promise.resolve();var e=this;return new Promise((function(t,r){var n=e.mediaStream.getVideoTracks().length,i=0;e.mediaStream.getVideoTracks().forEach((function(r){e.mediaStream.removeTrack(r),r.stop(),++i>=n&&(e.isClosed=!0,e.parentElement.removeChild(e.surface),t())}))}))},e.prototype.getCapabilities=function(){return new y(this.getFirstTrackOrFail())},e}(),g=function(){function e(e){this.mediaStream=e}return e.prototype.render=function(e,t){return d(this,void 0,void 0,(function(){return h(this,(function(r){return[2,v.create(e,this.mediaStream,t)]}))}))},e.create=function(t){return d(this,void 0,void 0,(function(){var r;return h(this,(function(n){switch(n.label){case 0:if(!navigator.mediaDevices)throw"navigator.mediaDevices not supported";return r={audio:!1,video:t},[4,navigator.mediaDevices.getUserMedia(r)];case 1:return[2,new e(n.sent())]}}))}))},e}(),b=function(e,t,r,n){return new(r||(r=Promise))((function(i,o){function a(e){try{c(n.next(e))}catch(e){o(e)}}function s(e){try{c(n.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}c((n=n.apply(e,t||[])).next())}))},S=function(e,t){var r,n,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(s){return function(c){return function(s){if(r)throw new TypeError("Generator is already executing.");for(;o&&(o=0,s[0]&&(a=0)),a;)try{if(r=1,n&&(i=2&s[0]?n.return:s[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,s[1])).done)return i;switch(n=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,n=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!((i=(i=a.trys).length>0&&i[i.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){a.label=s[1];break}if(6===s[0]&&a.label<i[1]){a.label=i[1],i=s;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(s);break}i[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],n=0}finally{r=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},C=function(){function e(){}return e.failIfNotSupported=function(){return b(this,void 0,void 0,(function(){return S(this,(function(t){if(!navigator.mediaDevices)throw"navigator.mediaDevices not supported";return[2,new e]}))}))},e.prototype.create=function(e){return b(this,void 0,void 0,(function(){return S(this,(function(t){return[2,g.create(e)]}))}))},e}(),k=function(){function e(){}return e.codeParseError=function(e){return"QR code parse error, error = ".concat(e)},e.errorGettingUserMedia=function(e){return"Error getting userMedia, error = ".concat(e)},e.onlyDeviceSupportedError=function(){return"The device doesn't support navigator.mediaDevices , only supported cameraIdOrConfig in this case is deviceId parameter (string)."},e.cameraStreamingNotSupported=function(){return"Camera streaming not supported by the browser."},e.unableToQuerySupportedDevices=function(){return"Unable to query supported devices, unknown error."},e.insecureContextCameraQueryError=function(){return"Camera access is only supported in secure context like https or localhost."},e.scannerPaused=function(){return"Scanner paused"},e}(),E=function(){function e(){}return e.scanningStatus=function(){return"Scanning"},e.idleStatus=function(){return"Idle"},e.errorStatus=function(){return"Error"},e.permissionStatus=function(){return"Permission"},e.noCameraFoundErrorStatus=function(){return"No Cameras"},e.lastMatch=function(e){return"Last Match: ".concat(e)},e.codeScannerTitle=function(){return"Code Scanner"},e.cameraPermissionTitle=function(){return"Request Camera Permissions"},e.cameraPermissionRequesting=function(){return"Requesting camera permissions..."},e.noCameraFound=function(){return"No camera found"},e.scanButtonStopScanningText=function(){return"Stop Scanning"},e.scanButtonStartScanningText=function(){return"Start Scanning"},e.flashOnButton=function(){return"Switch On Flash"},e.flashOffButton=function(){return"Switch Off Flash"},e.flashOnFailedMessage=function(){return"Failed to turn on flash"},e.flashOffFailedMessage=function(){return"Failed to turn off flash"},e.scanButtonScanningStarting=function(){return"Launching Camera..."},e.textIfCameraScanSelected=function(){return"Scan an Image File"},e.textIfFileScanSelected=function(){return"Scan using camera directly"},e.selectCamera=function(){return"Select Camera"},e.fileSelectionChooseImage=function(){return"Choose Image"},e.fileSelectionChooseAnother=function(){return"Choose Another"},e.fileSelectionNoImageSelected=function(){return"No image choosen"},e.anonymousCameraPrefix=function(){return"Anonymous Camera"},e.dragAndDropMessage=function(){return"Or drop an image to scan"},e.dragAndDropMessageOnlyImages=function(){return"Or drop an image to scan (other files not supported)"},e.zoom=function(){return"zoom"},e.loadingImage=function(){return"Loading image..."},e.cameraScanAltText=function(){return"Camera based scan"},e.fileScanAltText=function(){return"Fule based scan"},e}(),x=(function(){function e(){}e.poweredBy=function(){return"Powered by "},e.reportIssues=function(){return"Report issues"}}(),function(){function e(){}return e.prototype.render=function(e,t){var r=document.createElement("div");r.className="".concat(c.LOADER_DIV," ").concat(c.DNONE);var n=document.createElement("div");n.className=c.LOADER_CONTENT_DIV;for(var i=1;i<=10;i++){var o=document.createElement("span");o.setAttribute("style","--i:"+i),n.appendChild(o)}r.appendChild(n),e.appendChild(r),t.push((function(e){e?r.classList.remove(c.DNONE):r.classList.add(c.DNONE)}))},e.create=function(t,r){var n=new e;return n.render(t,r),n},e}()),w=function(e,t,r){if(r||2===arguments.length)for(var n,i=0,o=t.length;i<o;i++)!n&&i in t||(n||(n=Array.prototype.slice.call(t,0,i)),n[i]=t[i]);return e.concat(n||Array.prototype.slice.call(t))},I=function(){function e(){}return e.createBasicLayout=function(e){var t=document.createElement("div");t.className=c.CONTAINER_DIV;var r=document.createElement("div");r.className=c.CONTAINER_INNER_DIV,r.insertAdjacentHTML("beforeend",'<style>.ekyct-btn,.ekyct-zoom-container span{color:#fff}.ekyct-container,.ekyct-container *{margin:0;padding:0;box-sizing:border-box}.ekyct-capture-region.ekyct-hide-shading .ekyct-shading,.ekyct-dnone{display:none!important}.ekyct-container{position:fixed;top:0;left:0;background-color:#202124;z-index:999;height:100%;width:100%;font-family:Arial,Helvetica,sans-serif;display:flex;align-items:center;justify-content:center}.ekyct-capture-region,.ekyct-container--inner{position:relative;display:flex;height:100%;overflow:hidden}.ekyct-container--inner{flex-direction:column;width:100%;max-width:800px}.ekyct-container--rotate{align-items:center;flex-direction:row}.ekyct-container--rotate .ekyct-capture-region{max-width:620px;max-height:unset}.ekyct-container--rotate .ekyct-footer,.ekyct-container--rotate .ekyct-header{width:unset;height:100%}.ekyct-container--rotate .ekyct-footer--inner,.ekyct-container--rotate .ekyct-header--inner{width:unset;height:100%;flex-direction:column-reverse}.ekyct-btn{border:none;outline:0;background-color:#3c4043;padding:16px;cursor:pointer;line-height:0;border-radius:50%}.ekyct-btn:hover{background-color:#4b5053}.ekyct-btn:active{background-color:#5a5f63}.ekyct-btn:disabled{background-color:#2b2d30;color:#727275;cursor:default}.ekyct-btn svg{fill:currentColor;width:28px;height:28px}.ekyct-body{width:100%;height:100%;display:flex;align-items:center;justify-content:center}.ekyct-capture-region{width:100%;flex-grow:1;align-items:center;justify-content:center;background:#161619;z-index:1}.ekyct-zoom-container{position:absolute;bottom:2rem;right:50%;transform:translateX(50%);z-index:3;width:60%;display:flex;align-items:center;gap:.5rem;transition:opacity .2s ease-out;opacity:0}.ekyct-zoom-container input{flex-grow:1}.ekyct-capture-region:hover .ekyct-zoom-container{opacity:1}.ekyct-hide-shader-border .ekyct-shading{overflow:hidden}.ekyct-circle-region{display:none}.ekyct-hide-shader-border .ekyct-circle-region{display:flex;width:100%;height:100%;justify-content:center;align-items:center;rotate:180deg;border-radius:50%;box-shadow:0 0 0 1000px rgba(0,0,0,.5)}.ekyct-circle-region-point{width:4px;height:16px;background-color:rgba(0,0,0,.5);position:absolute;border-radius:4px;transition:10ms ease-out}.ekyct-circle-region-point--marked{background-color:#0f0;box-shadow:0 0 10px #0f0}.ekyct-alert,.ekyct-shader-border{background-color:#fff;position:absolute}.ekyct-footer{display:flex;align-items:center}.ekyct-footer,.ekyct-header{width:100%;flex-grow:1}.ekyct-header--inner{width:100%;display:flex;justify-content:flex-end;padding:20px}.ekyct-header--inner .ekyct-btn{padding:6px}.ekyct-footer--inner{width:100%;display:flex;padding:20px;justify-content:center;gap:1rem}.ekyct-cam-error{width:100%;height:100%}.ekyct-cam-error--inner{width:100%;height:100%;display:flex;justify-content:center;align-items:center;flex-direction:column}.ekyct-cam-error--inner p,.ekyct-cam-error--inner span{color:#ff5100;font-size:12px;text-align:center}.ekyct-cam-error--inner svg{fill:currentColor;width:100px;height:100px}.ekyct-shading{position:absolute;border-style:solid;border-color:rgba(0,0,0,.5);z-index:2}.ekyct-video{width:100%;display:block;position:absolute;z-index:-2}.ekyct-alert{top:10px;right:-10px;transform:translateX(100%);border-radius:4px;font-size:12px;transition:.2s ease-out;max-width:80%;text-align:left;display:flex;z-index:101}.ekyct-alert-header{border-bottom:1px solid rgba(0,0,0,.08);padding:8px 0 8px 4px;display:flex;align-items:center;flex-direction:column}.ekyct-alert.ekyct-alert-column{flex-direction:column}.ekyct-alert.ekyct-alert-reverse{flex-direction:row-reverse}.ekyct-alert-column.ekyct-alert-reverse{flex-direction:column-reverse}.ekyct-alert-reverse .ekyct-alert-header{padding:8px 4px 8px 0}.ekyct-alert-column .ekyct-alert-header{padding:4px 8px;gap:8px;flex-direction:row}.ekyct-alert-header .ekyct-alert-close-btn{background-color:unset;color:rgba(0,0,0,.6);padding:0}.ekyct-alert-header .ekyct-alert-close-btn:hover{color:rgba(0,0,0,.8)}.ekyct-alert-header .ekyct-alert-close-btn:active{color:#000}.ekyct-alert-header .ekyct-alert-close-btn svg{width:16px;height:16px}.ekyct-alert-title{font-weight:700;font-size:16px;flex-grow:1;vertical-align:middle;overflow:hidden;-webkit-line-clamp:1;display:box;display:-webkit-box;-webkit-box-orient:vertical;text-overflow:ellipsis;white-space:normal}.ekyct-alert-body{padding:8px}.ekyct-alert.warning{border:1px solid #ffae00;color:#ffae00}.ekyct-alert.active{right:10px;transform:translateX(0)}.ekyct-loader{position:absolute;top:0;left:0;right:0;bottom:0;background-color:rgba(0,0,0,.5);display:flex;align-items:center;justify-content:center;z-index:100}.ekyct-loader-content{position:relative;width:48px;height:48px}.ekyct-loader-content span{position:absolute;top:0;left:0;width:100%;height:100%;transform:rotate(calc(36deg * var(--i)))}.ekyct-loader-content span::before{content:"";position:absolute;top:0;left:0;width:12px;height:12px;border-radius:50%;background-color:rgba(254,254,254,.8);transform:scale(0);animation:1s linear infinite loaderAnimate;animation-delay:calc(.1s * var(--i))}@keyframes loaderAnimate{0%{transform:scale(1)}100%,80%{transform:scale(0)}}.ekyct-circular-progress{position:absolute;width:90px;height:90px;display:flex;align-items:center;justify-content:center;background-color:transparent}.ekyct-circular-progress svg{width:100%;height:100%;transform:rotate(270deg)}.ekyct-circular-progress svg circle{width:100%;height:100%;fill:transparent;stroke-width:3;stroke:#191919;transform:translate(6px,6px)}.ekyct-circular-progress svg circle:last-child{stroke:#0f0;stroke-dasharray:252;stroke-dashoffset:calc(252 - (252 * var(--percent))/ 100)}.ekyct-circular-progress span{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);color:#fff;font-weight:700;font-size:14px}@media (min-width:768px){.ekyct-alert,.ekyct-cam-error--inner p,.ekyct-cam-error--inner span{font-size:14px}.ekyct-alert-header{padding:10px 0 10px 6px}.ekyct-alert-reverse .ekyct-alert-header{padding:10px 6px 10px 0}.ekyct-alert-column .ekyct-alert-header{padding:6px 10px;gap:10px}.ekyct-alert-reverse.ekyct-alert-column .ekyct-alert-header{border-top:1px solid rgba(0,0,0,.08);border-bottom:unset}.ekyct-alert-header .ekyct-alert-close-btn svg{width:18px;height:18px}.ekyct-alert-title{font-size:18px}.ekyct-alert-body{padding:10px}.ekyct-cam-error--inner svg{width:140px;height:140px}.ekyct-loader-content{width:54px;height:54px}.ekyct-loader-content span::before{width:14px;height:14px}}@media (min-width:992px){.ekyct-loader-content{width:60px;height:60px}.ekyct-loader-content span::before{width:16px;height:16px}}</style>'),t.dataset.version="1.0.0";var n=document.createElement("div");n.className=c.CAPTURE_REGION_DIV,x.create(n,e);var i=this.createFooter(),o=document.createElement("div");return o.className=c.BODY_DIV,o.appendChild(n),r.appendChild(this.createHeader()),r.appendChild(o),r.appendChild(i),t.appendChild(r),t},e.handleOnScreenResize=function(e){var t,r=this;null===(t=s.closestByClassName(c.CONTAINER_DIV,e))||void 0===t||t.dispatchEvent(new CustomEvent(l.UI_LOADING)),setTimeout((function(){r.setupUI(e)}),this.delaySetupUIMs)},e.setupCamera=function(e,t,r){var n=this;void 0===r&&(r=null);var i=s.closestByClassName(c.CONTAINER_DIV,e);null==i||i.dispatchEvent(new CustomEvent(l.UI_LOADING));var o={onRenderSurfaceReady:function(){n.setupUI(e)}};return new Promise((function(a,s){r?r.close().then((function(){return n.renderCamera(e,i,o,a,s,t)})).catch((function(e){null==i||i.dispatchEvent(new CustomEvent(l.UI_LOADED,{detail:{error:e}})),s(e)})):n.renderCamera(e,i,o,a,s,t)}))},e.setupUI=function(e){var t=this,r=s.closestByClassName(c.CONTAINER_INNER_DIV,e);r.clientWidth>=r.clientHeight?r.classList.add(c.CONTAINER_INNER_ROTATE_DIV):r.classList.remove(c.CONTAINER_INNER_ROTATE_DIV),setTimeout((function(){var r=s.queryByClassName(c.VIDEO,e),n=r.clientWidth,i=r.clientHeight;t.insertShadingElement(e,n,i),t.insertCanvasElement(e,n,i)}),this.delaySetupUIMs)},e.getCapture=function(e){var t=this;return new Promise((function(r,n){var i=s.queryByClassName(c.CANVAS,e),o=s.queryByClassName(c.VIDEO,e);if(o&&i){var a=i.getContext("2d",{willReadFrequently:!0}),l=s.queryByClassName(c.SHADING_DIV,e),u=0,d=0,h=o.clientWidth,p=e.clientHeight>o.clientHeight?o.clientHeight:e.clientHeight;l&&(u=parseFloat(l.style.borderLeftWidth.slice(0,-2)),d=parseFloat(l.style.borderTopWidth.slice(0,-2)),h=parseFloat(l.style.width.slice(0,-2)),p=parseFloat(l.style.height.slice(0,-2)));var f=h-2*u,m=p-2*d,y=o.videoWidth/o.clientWidth,v=o.videoHeight/o.clientHeight,g=0;o.clientHeight>p&&(g=(o.clientHeight-p)/2);var b=Math.round(u*y),S=Math.round((d+g)*v),C=Math.round(f*y),k=Math.round(m*v);C%2!=0&&(C-=1),k%2!=0&&(k-=1);var E=parseInt(i.style.width.slice(0,-2)),x=parseInt(i.style.height.slice(0,-2));a.canvas.width=E,a.canvas.height=x,a.drawImage(o,b,S,C,k,0,0,E,x),t.getBlobFromCanvas(i,"image/png").then((function(e){r(e)})).catch((function(e){n(e)}))}else n("Video element is not exists.")}))},e.getBlobFromCanvas=function(e,t){return new Promise((function(r){e.toBlob((function(e){return r(e)}),t)}))},e.addAlert=function(e,t){var r=s.queryByClassName(c.CAPTURE_REGION_DIV,e);if(t.parentSelector){var n=e.querySelector(t.parentSelector);n&&(r=n)}if(r){var i=r.querySelector(".ekyct-alert");i?this.getAlertContent(i)!==t.content&&(i.classList.contains("active")&&!this.insertAlertTimeout&&i.classList.remove("active"),this.insertAlertTimeout||(this.setAlertContent(i,t.content),"number"==typeof t.displayTimeout&&t.displayTimeout>=1e3?this.setInsertAlertTimeout(i,t.displayTimeout+200,200):i.classList.add("active"))):(i=this.createAlertElement(t.content,t.title,t.classList,t.enableClose),r.appendChild(i),i.classList.contains("active")||this.insertAlertTimeout||(this.setAlertContent(i,t.content),"number"==typeof t.displayTimeout&&t.displayTimeout>=1e3?this.setInsertAlertTimeout(i,t.displayTimeout+20,20):i.classList.add("active")))}},e.createAlertElement=function(e,t,r,n){var i,o=document.createElement("div"),a=["ekyct-alert"];if("string"==typeof t&&t.trim().length>0||"boolean"==typeof n&&n){var s=document.createElement("div");if(s.className="ekyct-alert-header","string"==typeof t){t=t.trim();var c=document.createElement("div");c.className="ekyct-alert-title",s.appendChild(c),c.innerHTML=t,a.push("ekyct-alert-column")}if("boolean"==typeof n&&n){var l=document.createElement("button");l.className="ekyct-btn ekyct-alert-close-btn",l.innerHTML='<svg viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"></path></svg>',l.addEventListener("click",(function(e){e.preventDefault(),o.classList.remove("active")}),{once:!0}),s.appendChild(l)}o.appendChild(s)}var u=document.createElement("div");return u.className="ekyct-alert-body",o.appendChild(u),Array.isArray(r)&&r.length>0&&(a=w(w([],a,!0),r,!0)),"string"==typeof e&&e.trim().length>0&&(e=e.trim(),u.innerHTML=e),(i=o.classList).add.apply(i,a),o},e.getAlertContent=function(e){var t=e.querySelector(".ekyct-alert-body");return t?t.innerHTML:""},e.setAlertContent=function(e,t){if("string"==typeof t&&t.trim().length>0){var r=e.querySelector(".ekyct-alert-body");r&&(r.innerHTML=t)}},e.setInsertAlertTimeout=function(e,t,r){var n=this;this.insertAlertTimeout=setTimeout((function(){e.classList.add("active"),setTimeout((function(){n.clearInsertAlertTimeout()}),t)}),r)},e.clearInsertAlertTimeout=function(){this.insertAlertTimeout&&(clearTimeout(this.insertAlertTimeout),this.insertAlertTimeout=null)},e.renderCamera=function(e,t,r,n,i,o){C.failIfNotSupported().then((function(a){a.create(o).then((function(o){o.render(e,r).then((function(e){n(e)})).catch((function(e){null==t||t.dispatchEvent(new CustomEvent(l.UI_LOADED,{detail:{error:e}})),i(e)}))})).catch((function(e){null==t||t.dispatchEvent(new CustomEvent(l.UI_LOADED,{detail:{error:e}})),i(k.errorGettingUserMedia(e))}))})).catch((function(e){null==t||t.dispatchEvent(new CustomEvent(l.UI_LOADED,{detail:{error:e}})),i(k.cameraStreamingNotSupported())}))},e.insertShadingElement=function(e,t,r){var n,i,o=parseFloat(null!==(n=e.dataset.shadingRatio)&&void 0!==n?n:"0");if((isNaN(o)||o<0)&&(o=0),o>0){null===(i=s.queryByClassName(c.SHADING_DIV,e))||void 0===i||i.remove();var a=e.clientHeight>r?r:e.clientHeight,l=document.createElement("div");l.className=c.SHADING_DIV,l.style.width="".concat(t,"px"),l.style.height="".concat(a,"px");var u=this.getShadingBorderSize(t,a,o);return l.style.borderLeftWidth="".concat(u.borderX,"px"),l.style.borderRightWidth="".concat(u.borderX,"px"),l.style.borderTopWidth="".concat(u.borderY,"px"),l.style.borderBottomWidth="".concat(u.borderY,"px"),this.insertShaderBorders(l,this.shardBorderLargeSize,this.shardBorderSmallSize,-this.shardBorderSmallSize,null,0,!0),this.insertShaderBorders(l,this.shardBorderLargeSize,this.shardBorderSmallSize,-this.shardBorderSmallSize,null,0,!1),this.insertShaderBorders(l,this.shardBorderLargeSize,this.shardBorderSmallSize,null,-this.shardBorderSmallSize,0,!0),this.insertShaderBorders(l,this.shardBorderLargeSize,this.shardBorderSmallSize,null,-this.shardBorderSmallSize,0,!1),this.insertShaderBorders(l,this.shardBorderSmallSize,this.shardBorderLargeSize+this.shardBorderSmallSize,-this.shardBorderSmallSize,null,-this.shardBorderSmallSize,!0),this.insertShaderBorders(l,this.shardBorderSmallSize,this.shardBorderLargeSize+this.shardBorderSmallSize,null,-this.shardBorderSmallSize,-this.shardBorderSmallSize,!0),this.insertShaderBorders(l,this.shardBorderSmallSize,this.shardBorderLargeSize+this.shardBorderSmallSize,-this.shardBorderSmallSize,null,-this.shardBorderSmallSize,!1),this.insertShaderBorders(l,this.shardBorderSmallSize,this.shardBorderLargeSize+this.shardBorderSmallSize,null,-this.shardBorderSmallSize,-this.shardBorderSmallSize,!1),e.appendChild(l),l}return null},e.insertCanvasElement=function(e,t,r){var n,i,o,a,u=parseFloat(null!==(n=e.dataset.canvasMaxWidth)&&void 0!==n?n:"0");(isNaN(u)||u<0)&&(u=0),u%2!=0&&(u-=1);var d=parseFloat(null!==(i=e.dataset.canvasMinWidth)&&void 0!==i?i:"0");(isNaN(d)||d<0)&&(d=0),d%2!=0&&(d+=1);var h=s.queryByClassName(c.SHADING_DIV,e),p=0,f=0,m=t,y=e.clientHeight>r?r:e.clientHeight;h&&(p=2*parseFloat(h.style.borderLeftWidth.slice(0,-2)),f=2*parseFloat(h.style.borderTopWidth.slice(0,-2)),m=parseFloat(h.style.width.slice(0,-2)),y=parseFloat(h.style.height.slice(0,-2))),null===(o=s.queryByClassName(c.CANVAS,e))||void 0===o||o.remove();var v=m-p,g=y-f;u>0&&v>u?v=u:d>0&&v<d&&(v=d),(v=Math.floor(v))%2!=0&&(v+=1),v!==u&&v!==d||(g=v*g/(m-p)),(g=Math.floor(g))%2!=0&&(g+=1);var b=document.createElement("canvas");return b.className=c.CANVAS,b.style.width="".concat(v,"px"),b.style.height="".concat(g,"px"),b.style.display="none",e.appendChild(b),null===(a=s.closestByClassName(c.CONTAINER_DIV,e))||void 0===a||a.dispatchEvent(new CustomEvent(l.UI_LOADED,{detail:{canvas:b}})),b},e.insertShaderBorders=function(e,t,r,n,i,o,a){var s=document.createElement("div");s.className="ekyct-shader-border",s.style.width="".concat(t,"px"),s.style.height="".concat(r,"px"),null!==n&&(s.style.top="".concat(n,"px")),null!==i&&(s.style.bottom="".concat(i,"px")),a?s.style.left="".concat(o,"px"):s.style.right="".concat(o,"px"),e.appendChild(s)},e.getShadingBorderSize=function(e,t,r){var n=s.adjustExactRatio([e,t,r]),i=(e-n[0])/2,o=(t-n[1])/2;return o<4*this.shardBorderSmallSize&&(i+=4*this.shardBorderSmallSize-o,o=4*this.shardBorderSmallSize),i<4*this.shardBorderSmallSize&&(o+=4*this.shardBorderSmallSize-i,i=4*this.shardBorderSmallSize),{borderX:i,borderY:o}},e.createHeader=function(){var e=document.createElement("div");e.className="ekyct-header";var t=document.createElement("div");t.className="ekyct-header--inner";var r=document.createElement("button");return r.className="ekyct-btn ".concat(c.CLOSE_BTN),r.disabled=!0,r.innerHTML='<svg viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"></path></svg>',t.appendChild(r),e.appendChild(t),e},e.createFooter=function(){var e=document.createElement("div");e.className=c.FOOTER_DIV;var t=document.createElement("div");return t.className=c.FOOTER_INNER_DIV,e.appendChild(t),e},e.insertAlertTimeout=null,e.shardBorderLargeSize=40,e.shardBorderSmallSize=5,e.delaySetupUIMs=50,e}(),T=function(){function e(){}return e.retrieve=function(){if(navigator.mediaDevices)return e.getCamerasFromMediaDevices();var t=MediaStreamTrack;return MediaStreamTrack&&t.getSources?e.getCamerasFromMediaStreamTrack():e.rejectWithError()},e.rejectWithError=function(){var t=k.unableToQuerySupportedDevices();return e.isHttpsOrLocalhost()||(t=k.insecureContextCameraQueryError()),Promise.reject(t)},e.isHttpsOrLocalhost=function(){if("https:"===location.protocol)return!0;var e=location.host.split(":")[0];return"127.0.0.1"===e||"localhost"===e},e.getCamerasFromMediaDevices=function(){return e=this,t=void 0,n=function(){var e,t,r,n,i,o,a;return function(e,t){var r,n,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(s){return function(c){return function(s){if(r)throw new TypeError("Generator is already executing.");for(;o&&(o=0,s[0]&&(a=0)),a;)try{if(r=1,n&&(i=2&s[0]?n.return:s[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,s[1])).done)return i;switch(n=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,n=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!((i=(i=a.trys).length>0&&i[i.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){a.label=s[1];break}if(6===s[0]&&a.label<i[1]){a.label=i[1],i=s;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(s);break}i[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],n=0}finally{r=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}}(this,(function(s){switch(s.label){case 0:return e=function(e){for(var t=0,r=e.getVideoTracks();t<r.length;t++){var n=r[t];n.enabled=!1,n.stop(),e.removeTrack(n)}},[4,navigator.mediaDevices.getUserMedia({audio:!1,video:!0})];case 1:return t=s.sent(),[4,navigator.mediaDevices.enumerateDevices()];case 2:for(r=s.sent(),n=[],i=0,o=r;i<o.length;i++)"videoinput"===(a=o[i]).kind&&n.push({id:a.deviceId,label:a.label});return e(t),[2,n]}}))},new((r=void 0)||(r=Promise))((function(i,o){function a(e){try{c(n.next(e))}catch(e){o(e)}}function s(e){try{c(n.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}c((n=n.apply(e,t||[])).next())}));var e,t,r,n},e.getCamerasFromMediaStreamTrack=function(){return new Promise((function(e,t){MediaStreamTrack.getSources((function(t){for(var r=[],n=0,i=t;n<i.length;n++){var o=i[n];"video"===o.kind&&r.push({id:o.id,label:o.label})}e(r)}))}))},e}(),B=(function(){function e(){}e.createImageResult=function(e){return e?{blob:e,contentName:"".concat(s.newGuid(),".png"),contentLength:e.size,contentType:"image/png"}:null},e.createVideoResult=function(e,t){if(e){var r=this.createImageResult(t);return{blob:e,contentName:"".concat(s.newGuid(),".webm"),contentLength:e.size,contentType:"video/webm",poster:r}}return null}}(),function(){function e(e){this.verbose=e}return e.prototype.log=function(e){this.verbose&&console.log(e)},e.prototype.warn=function(e){this.verbose&&console.warn(e)},e.prototype.logError=function(e,t){(this.verbose||!0===t)&&console.error(e)},e.prototype.logErrors=function(e){if(0===e.length)throw"Logger#logError called without arguments";this.verbose&&console.error(e)},e}()),N=function(){function e(e,t,r,n,i){var o=document.createElement("button");o.className="ekyct-btn ".concat(c.FILE_PICKER_BTN),o.innerHTML='<svg viewBox="0 0 24 24"><path d="M20 6h-8l-2-2H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V8c0-1.1-.9-2-2-2zm0 12H4V8h16v10z"></path></svg>',o.disabled=!0;var a=document.createElement("input");a.type="file",a.accept=t,a.onchange=function(){if(a.files){var e=a.files[0];i&&i({blob:e,contentName:"".concat(s.newGuid(),".png"),contentLength:e.size,contentType:e.type})}},o.addEventListener("click",(function(e){e.preventDefault(),a.click(),n&&n()})),r.push((function(e){o.disabled=!!e})),e.appendChild(o)}return e.create=function(t,r,n,i,o){return new e(t,r,n,i,o)},e}(),L=function(){function e(e,t){this.deviceIndex=-1,this.cameras=e,t&&(this.deviceIndex=e.findIndex((function(e){return e.id===t})),-1===this.deviceIndex&&(this.deviceIndex=0))}return e.prototype.render=function(e,t){var r=this;if(this.cameras.length>1){var n=s.closestByClassName(c.CONTAINER_DIV,e),i=document.createElement("button");i.className="ekyct-btn ".concat(c.SWITCH_CAMERA_BTN),i.innerHTML='<svg viewBox="0 0 24 24"><path d="M16 7h-1l-1-1h-4L9 7H8c-1.1 0-2 .9-2 2v6c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V9c0-1.1-.9-2-2-2zm-4 7c-1.1 0-2-.9-2-2s.9-2 2-2 2 .9 2 2-.9 2-2 2z"></path><path d="m8.57.51 4.48 4.48V2.04c4.72.47 8.48 4.23 8.95 8.95h2C23.34 3.02 15.49-1.59 8.57.51zm2.38 21.45c-4.72-.47-8.48-4.23-8.95-8.95H0c.66 7.97 8.51 12.58 15.43 10.48l-4.48-4.48v2.95z"></path></svg>',i.disabled=!0,i.addEventListener("click",(function(e){e.preventDefault(),r.deviceIndex===r.cameras.length-1?r.deviceIndex=0:r.deviceIndex++;var t=new CustomEvent(l.SWITCH_CAMERA,{detail:{deviceId:r.cameras[r.deviceIndex].id}});n.dispatchEvent(t)})),t.push((function(e){i.disabled=!!e})),e.appendChild(i)}},e.create=function(t,r,n,i){var o=new e(r,i);return o.render(t,n),o},e}(),A=function(e,t,r,n){return new(r||(r=Promise))((function(i,o){function a(e){try{c(n.next(e))}catch(e){o(e)}}function s(e){try{c(n.throw(e))}catch(e){o(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,s)}c((n=n.apply(e,t||[])).next())}))},z=function(e,t){var r,n,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(s){return function(c){return function(s){if(r)throw new TypeError("Generator is already executing.");for(;o&&(o=0,s[0]&&(a=0)),a;)try{if(r=1,n&&(i=2&s[0]?n.return:s[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,s[1])).done)return i;switch(n=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,n=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!((i=(i=a.trys).length>0&&i[i.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){a.label=s[1];break}if(6===s[0]&&a.label<i[1]){a.label=i[1],i=s;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(s);break}i[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],n=0}finally{r=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}},O=function(){function e(e,t,r){this.isFlashOn=!1,this.flashCapability=e,this.buttonController=t,this.onFlashActionFailureCallback=r}return e.prototype.isFlashEnabled=function(){return this.isFlashOn},e.prototype.flipState=function(){return A(this,void 0,void 0,(function(){var e,t;return z(this,(function(r){switch(r.label){case 0:this.buttonController.disable(),e=!this.isFlashOn,r.label=1;case 1:return r.trys.push([1,3,,4]),[4,this.flashCapability.apply(e)];case 2:return r.sent(),this.updateUiBasedOnLatestSettings(this.flashCapability.value(),e),[3,4];case 3:return t=r.sent(),this.propagateFailure(e,t),this.buttonController.enable(),[3,4];case 4:return[2]}}))}))},e.prototype.updateUiBasedOnLatestSettings=function(e,t){e===t?(this.buttonController.setHTML(t?'<svg viewBox="0 0 24 24"><path d="M3.27 3 2 4.27l5 5V13h3v9l3.58-6.14L17.73 20 19 18.73 3.27 3zM17 10h-4l4-8H7v2.18l8.46 8.46L17 10z"></path></svg>':n),this.isFlashOn=t):this.propagateFailure(t),this.buttonController.enable()},e.prototype.propagateFailure=function(e,t){var r=e?E.flashOnFailedMessage():E.flashOffFailedMessage();t&&(r+="; Error = "+t),this.onFlashActionFailureCallback(r)},e.prototype.reset=function(){this.isFlashOn=!1},e}(),R=function(){function e(e,t){this.onFlashActionFailureCallback=t,this.flashButton=document.createElement("button"),this.flashUI=new O(e,this,t)}return e.prototype.render=function(e,t){var r=this;this.flashButton.className="ekyct-btn ".concat(c.FLASH_BTN),this.flashButton.disabled=!0,this.flashButton.addEventListener("click",(function(e){return A(r,void 0,void 0,(function(){return z(this,(function(t){switch(t.label){case 0:return e.preventDefault(),[4,this.flashUI.flipState()];case 1:return t.sent(),[2]}}))}))})),t.push((function(e){r.flashButton.disabled=!!e})),e.appendChild(this.flashButton)},e.prototype.updateFlashCapability=function(e){this.flashUI=new O(e,this,this.onFlashActionFailureCallback)},e.prototype.hide=function(){this.flashButton.classList.add(c.DNONE)},e.prototype.show=function(){this.flashButton.innerHTML=n,this.flashButton.classList.remove(c.DNONE)},e.prototype.disable=function(){this.flashButton.disabled=!0},e.prototype.enable=function(){this.flashButton.disabled=!1},e.prototype.setHTML=function(e){this.flashButton.innerHTML=e},e.prototype.reset=function(){this.flashButton.innerHTML=n,this.flashUI.reset()},e.create=function(t,r,n,i){var o=new e(r,n);return o.render(t,i),o},e}(),M=function(){function e(e,t,r,n){this.captureRegion=e,this.onStart=t,this.onStop=r,this.onError=n}return e.prototype.render=function(e){var t,r=this;null===(t=s.queryByClassName(c.CAPTURE_BTN,e))||void 0===t||t.remove();var n=document.createElement("button");n.className="ekyct-btn ".concat(c.CAPTURE_BTN),n.innerHTML='<svg viewBox="0 0 24 24"><circle cx="12" cy="12" r="3.2"></circle><path d="M9 2 7.17 4H4c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2h-3.17L15 2H9zm3 15c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5z"></path></svg>',n.addEventListener("click",(function(e){r.onStart&&r.onStart(),e.preventDefault(),I.getCapture(r.captureRegion).then((function(e){r.onStop&&(e?r.onStop({blob:e,contentName:"".concat(s.newGuid(),".png"),contentLength:e.size,contentType:"image/png"}):r.onStop(null))})).catch((function(e){r.onError&&r.onError(e)}))})),e.appendChild(n)},e.create=function(t,r,n,i,o){var a=new e(r,n,i,o);return a.render(t),a},e}(),D=function(){function e(){this.onChangeCallback=null,this.zoomElementContainer=document.createElement("div"),this.zoomElementContainer.className=c.ZOOM_CONTAINER_DIV,this.rangeInput=document.createElement("input"),this.rangeInput.type="range",this.rangeText=document.createElement("span"),this.rangeInput.min="1",this.rangeInput.max="5",this.rangeInput.value="1",this.rangeInput.step="0.1"}return e.prototype.render=function(e){var t=this;e.appendChild(this.zoomElementContainer),this.rangeText.innerText="".concat(this.rangeInput.value,"x"),this.rangeInput.addEventListener("input",(function(){return t.onValueChange()})),this.rangeInput.addEventListener("change",(function(){return t.onValueChange()})),this.zoomElementContainer.appendChild(this.rangeInput),this.zoomElementContainer.appendChild(this.rangeText)},e.prototype.onValueChange=function(){this.rangeText.innerText="".concat(this.rangeInput.value,"x"),this.onChangeCallback&&this.onChangeCallback(parseFloat(this.rangeInput.value))},e.prototype.setValues=function(e,t,r,n){this.rangeInput.min=e.toString(),this.rangeInput.max=t.toString(),this.rangeInput.step=n.toString(),this.rangeInput.value=r.toString(),this.onValueChange()},e.prototype.show=function(){this.zoomElementContainer.classList.remove(c.DNONE)},e.prototype.hide=function(){this.zoomElementContainer.classList.add(c.DNONE)},e.prototype.setOnCameraZoomValueChangeCallback=function(e){this.onChangeCallback=e},e.prototype.removeOnCameraZoomValueChangeCallback=function(){this.onChangeCallback=null},e.create=function(t){var r=new e;return r.render(t),r},e}(),_=function(){function e(e){this.durationMilliseconds=0,this.progressMs=e,this.progressElement=document.createElement("div")}return e.prototype.render=function(e){this.progressElement.className=c.CIRCULAR_PROGRESS,this.progressElement.innerHTML='<svg><circle cx="40" cy="40" r="40"></circle><circle cx="40" cy="40" r="40"></circle></svg>';var t=document.createElement("span");this.progressElement.appendChild(t),this.setPercent(0),e.appendChild(this.progressElement)},e.prototype.setPercent=function(e){this.progressElement.setAttribute("style","--percent: "+e);var t=this.progressElement.querySelector("span");t&&(t.innerText="".concat(e,"%"))},e.prototype.start=function(){var t=this;return this.reset(),new Promise((function(r){t.interval=setInterval((function(){t.durationMilliseconds+=100;var e=Math.floor(t.durationMilliseconds/t.progressMs*100);t.setPercent(e),t.durationMilliseconds>=t.progressMs&&r(null)}),e.delayMilliseconds)}))},e.prototype.reset=function(){this.durationMilliseconds=0,this.setPercent(0),this.interval&&clearInterval(this.interval)},e.create=function(t,r){var n=new e(r);return n.render(t),n},e.delayMilliseconds=100,e}(),F=function(){function e(e,t,r,n){this.mediaStream=null,this.recorder=null,this.recordProgress=null,this.recording=!1,this.recordButton=document.createElement("button"),this.config=e,this.onStart=t,this.onStop=r,this.onError=n}return e.prototype.render=function(e,t,r){var n=this;this.recordButton.className="ekyct-btn ".concat(c.RECORD_BTN),this.recordButton.disabled=!0,this.recordButton.addEventListener("click",(function(e){e.preventDefault(),n.mediaStream&&!n.recording&&(n.recording=!0,n.onStart&&n.onStart(),n.recorder=new MediaRecorder(n.mediaStream,{videoBitsPerSecond:n.config.videoBitsPerSecond}),n.recorder.ondataavailable=function(e){return r=n,i=void 0,a=function(){var r,n,i,o;return function(e,t){var r,n,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(s){return function(c){return function(s){if(r)throw new TypeError("Generator is already executing.");for(;o&&(o=0,s[0]&&(a=0)),a;)try{if(r=1,n&&(i=2&s[0]?n.return:s[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,s[1])).done)return i;switch(n=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,n=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!((i=(i=a.trys).length>0&&i[i.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){a.label=s[1];break}if(6===s[0]&&a.label<i[1]){a.label=i[1],i=s;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(s);break}i[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],n=0}finally{r=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}}(this,(function(a){switch(a.label){case 0:return a.trys.push([0,3,,4]),this.onStop?(r=e.data,[4,I.getCapture(t)]):[3,2];case 1:n=a.sent(),i={blob:r,contentLength:r.size,contentType:"video/webm",contentName:"".concat(s.newGuid(),".webm"),poster:null},n&&(i.poster={blob:n,contentLength:n.size,contentName:"".concat(s.newGuid(),".png"),contentType:"image/png"}),this.recording=!1,this.onStop(i),a.label=2;case 2:return[3,4];case 3:return o=a.sent(),this.onError&&this.onError(o),[3,4];case 4:return[2]}}))},new((o=void 0)||(o=Promise))((function(e,t){function n(e){try{c(a.next(e))}catch(e){t(e)}}function s(e){try{c(a.throw(e))}catch(e){t(e)}}function c(t){var r;t.done?e(t.value):(r=t.value,r instanceof o?r:new o((function(e){e(r)}))).then(n,s)}c((a=a.apply(r,i||[])).next())}));var r,i,o,a},n.recorder.onstart=function(){if(n.recordProgress)n.recordProgress.reset();else{var e=n.config.recordMs&&n.config.recordMs%100==0&&n.config.recordMs>=1e3?n.config.recordMs:6e3;n.recordProgress=_.create(t,e)}n.recordProgress.start().then((function(){var e;null===(e=n.recorder)||void 0===e||e.stop()}))},n.recorder.start())})),e.appendChild(this.recordButton),r.push((function(e){n.recordButton.disabled=!!e}))},e.prototype.show=function(){this.recordButton.innerHTML='<svg viewBox="0 0 24 24"><path d="M17 10.5V7c0-.55-.45-1-1-1H4c-.55 0-1 .45-1 1v10c0 .55.45 1 1 1h12c.55 0 1-.45 1-1v-3.5l4 4v-11l-4 4z"></path></svg>',this.recordButton.classList.remove(c.DNONE)},e.prototype.setStream=function(e){this.mediaStream=e,this.recorder&&(this.recorder.stop(),this.recorder=null)},e.create=function(t,r,n,i,o,a,s){var c=new e(i,o,a,s);return c.render(t,r,n),c},e}(),H=function(){function e(e){this.loadHandlers=[],this.flashButton=null,this.zoomInput=null,this.recordUI=null,this.element=null,this.renderedCamera=null,this.verbose=!0===e,this.logger=new B(this.verbose)}return e.getCameraDevices=function(){return T.retrieve()},e.prototype.addAlert=function(e){this.element&&I.addAlert(this.element,e)},e.prototype.open=function(e){this.element=I.createBasicLayout(this.loadHandlers),document.body.appendChild(this.element),e.onOpen&&e.onOpen(),this.createSectionControlPanel(e)},e.prototype.close=function(){var e=this;return this.flashButton&&(this.flashButton.reset(),this.flashButton.hide()),this.zoomInput&&(this.zoomInput.removeOnCameraZoomValueChangeCallback(),this.zoomInput.hide()),new Promise((function(t,r){e.renderedCamera?e.renderedCamera.close().then((function(){e.element&&document.body.removeChild(e.element),t(null)})).catch((function(t){e.logger.logError(t),r(t)})):(e.element&&document.body.removeChild(e.element),t(null))}))},e.prototype.createSectionControlPanel=function(e){var t=this,r=s.queryByClassName(c.CAPTURE_REGION_DIV,this.element),n=s.queryByClassName(c.FOOTER_INNER_DIV,this.element),i=s.queryByClassName(c.CLOSE_BTN,this.element);r.dataset.shadingRatio=e.shadingRatio.toString(),r.dataset.canvasMaxWidth=e.canvasMaxWidth.toString(),r.dataset.canvasMinWidth=e.canvasMinWidth.toString(),this.loadHandlers.push((function(e){i.disabled=!!e})),i.addEventListener("click",(function(e){e.preventDefault(),t.close()}));var o=s.instanceOfGetVideoConfig(e),a=o?"video/mp4,video/webm,video/mov":"image/jpeg,image/png,image/webp";this.element.addEventListener(l.UI_LOADING,(function(){if(t.loadHandlers.forEach((function(e){return e(!0)})),!o){var e=s.queryByClassName(c.CAPTURE_BTN,t.element);e&&(e.disabled=!0)}})),this.element.addEventListener(l.UI_LOADED,(function(i){var a=i;t.loadHandlers.forEach((function(e){return e(!1)}));var s=a.detail.canvas,c=a.detail.error;s&&!o&&M.create(n,r,e.onStart,e.onStop,e.onError),c&&e.onError&&e.onError(c)})),e.enableFilePicker&&N.create(n,a,this.loadHandlers,e.onStart,e.onStop),e.enableSwitchCamera?T.retrieve().then((function(i){I.setupCamera(r,e.video).then((function(o){t.setRenderedCamera(o,e);var a=o.getRunningTrackSettings().deviceId;L.create(n,i,t.loadHandlers,a),t.element.addEventListener(l.SWITCH_CAMERA,(function(n){var i=n;"boolean"==typeof e.video?e.video={deviceId:{exact:i.detail.deviceId}}:e.video.deviceId={exact:i.detail.deviceId},I.setupCamera(r,e.video,t.renderedCamera).then((function(r){return t.setRenderedCamera(r,e)})).catch((function(e){return t.logger.logError(e)}))}))})).catch((function(e){return t.logger.logError(e)}))})).catch((function(e){var r;null===(r=t.element)||void 0===r||r.dispatchEvent(new CustomEvent(l.UI_LOADED)),t.logger.logError(e)})):I.setupCamera(r,e.video).then((function(r){return t.setRenderedCamera(r,e)})).catch((function(e){return t.logger.logError(e)}))},e.prototype.setRenderedCamera=function(e,t){this.renderedCamera=e;var r=e.getCapabilities();t.enableFlash&&this.createAndShowFlashButtonIfSupported(r),this.renderCameraZoomUiIfSupported(r,t.zoom),this.createAndShowRecordUI(e.getStream(),t)},e.prototype.createAndShowRecordUI=function(e,t){if(s.instanceOfGetVideoConfig(t)){if(!this.recordUI){var r=s.queryByClassName(c.FOOTER_INNER_DIV,this.element),n=s.queryByClassName(c.CAPTURE_REGION_DIV,this.element);this.recordUI=F.create(r,n,this.loadHandlers,{recordMs:t.recordMs,videoBitsPerSecond:t.videoBitsPerSecond},t.onStart,t.onStop,t.onError)}this.recordUI.setStream(e),this.recordUI.show()}},e.prototype.createAndShowFlashButtonIfSupported=function(e){var t=this;if(e.flashFeature().isSupported()){if(this.flashButton)this.flashButton.updateFlashCapability(e.flashFeature());else{var r=s.queryByClassName(c.FOOTER_INNER_DIV,this.element);this.flashButton=R.create(r,e.flashFeature(),(function(e){t.logger.logError(e)}),this.loadHandlers)}this.flashButton.show()}else this.flashButton&&this.flashButton.hide()},e.prototype.renderCameraZoomUiIfSupported=function(e,t){var r=e.zoomFeature();if(r.isSupported()){if(!this.zoomInput){var n=s.queryByClassName(c.CAPTURE_REGION_DIV,this.element);this.zoomInput=D.create(n)}this.zoomInput.setOnCameraZoomValueChangeCallback((function(e){r.apply(e)}));var i=1;t&&t>0&&(i=t),i=s.clip(i,r.min(),r.max()),this.zoomInput.setValues(r.min(),r.max(),i,r.step()),this.zoomInput.show()}},e}();window.addEventListener("resize",(function(){document.querySelectorAll(".".concat(c.CAPTURE_REGION_DIV)).forEach((function(e){I.handleOnScreenResize(e)}))})),__EkycToolsLibrary__=t})();if(window){if(!EkycTools){var EkycTools=window.__EkycToolsLibrary__.EkycTools}}